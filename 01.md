Введение в пакеные менеджеры
===

## Модульные системы

### Зачем нужны модули?

> Пример. Производители телефонов используют батарейки, которые производятся третьей стороной. Батарейка в данном случае - аппаратный модуль питания. 

**Модуль** — функционально законченный фрагмент. В разработке обычно оформляется в виде отдельного файла с исходным кодом, предоствляющим доступ к некоторому количеству функций.

**Модульное программирование** — это организация программы как набора независимых блоков, называемых модулями, структура и поведение которых подчиняются определённым правилам. 

Использование модульного программирования позволяет ускорить разработку и упростить тестирование и обнаружение ошибок.

Модули могут разрабатываться и поставляться независимо от основного проекта. Причем разработкой отдельных модулей могут заниматься различные команды. Данный подход позволяет переиспользовать в различных проектах просто подключая уже готовый функционал

В этом случае внешние модули становятся так называемыми **зависимостями** основного проекта. 

> Например система умный дом имеет основное управляющее устройство. Мы можем подключить к нему модуль пожаротушения и тогда добавляем зависимости в виде соответвующих утсройств.

Во время использовании сторонних модулей (библиотек, утилит и т.п.) возникает проблема поддержки актуальной версии этих зависимостей. 
Например при выходе исправлений в текущей версии библиотеки нужно обновить ее в проекте. 

Поэтому зависимости принято описывать в специальном файле и каждый разработчик заботится о том чтобы у него был актуальный набор зависимостей. Тут возникает еще одна проблема - у зависимостей могут быть свои зависимости. И их тоже нужно поддерживать в актаульном состоянии. 

> Например при установке системы пожаротушения нам еще может понадобиться модуль связи, который работает с телефонной линией, чтобы сообщить в пожарную часть.

При этом у некоторых библиотек могут быть общие зависимости. В этом случае нужно решить где их хранить: для каждой библиотеки в своей папке или где то на одном уровне с библиотеками и давать им способ доступа к общим зависимостям

> Продолжая пример. Мы добавили еще модуль сигнализации и подключения к интернету, которым тоже нужны модули связи. Причем для интернета нужен отдельный отдельный модуль, а для сигнализации такой же как и для системы пожаротушения. В этом случае подключить две системы по отдельности, а можно использовать один общий модуль связи.

## Нам нужна система управления нашими зависимостями
С ростом проекта количество зависимостей растет и нам нужны вспомогательные инструмены для работы с ними.

**Система управления пакетами (пакетный менеджер)** — набор программного обеспечения, позволяющего управлять процессом установки, удаления, настройки и обновления различных компонентов.

Для использования в системах управления пакетами программное обеспечение представляется в виде особых пакетов, содержащих помимо дистрибутива набор определённых метаданных, которые могут включать в себя полное имя пакета, номер версии, описание пакета, имя разработчика, контрольную сумму, отношения с другими пакетами. Метаданные сохраняются в системной базе данных пакетов.

Пример известных пакетных менеджров: *rpm* и *dpkg* используемые в различных дистрибутивах Linux.

Также используются пакетные менеджеры для различных языков программирования:
* npm для javascript
* pip для python
* gem для ruby on rails
* composer для php

Система управления пакетами работает со множеством пакетов, хранящихся в специальном репозитории — хранилище, которое  располагается на удалённой сервере и достпуно по различным протоколам (HTTP, FTP или rsync-сервере).

## npm - nodejs package manager

Пакетный менеджер для javascript библиотек - **npm**

**npm** - пакетный менеджер, поставляемый вместе с [nodejs](https://nodejs.org/en/). Для установки npm достаточно скачать установщик с сайта (https://nodejs.org/en). 

После установки в командной строке будут доступны команды `node` и `npm`

Запуск без агрументов позволяет просмотреть доступные команды
```bash
$> npm
Usage: npm <command>

where <command> is one of:
    access, adduser, bin, bugs, c, cache, completion, config,
    ddp, dedupe, deprecate, dist-tag, docs, doctor, edit,
    explore, get, help, help-search, i, init, install,
    install-test, it, link, list, ln, login, logout, ls,
    outdated, owner, pack, ping, prefix, prune, publish, rb,
    rebuild, repo, restart, root, run, run-script, s, se,
    search, set, shrinkwrap, star, stars, start, stop, t, team,
    test, tst, un, uninstall, unpublish, unstar, up, update, v,
    version, view, whoami

npm <command> -h     quick help on <command>
npm -l           display full usage info
npm help <term>  search for help on <term>
npm help npm     involved overview

Specify configs in the ini-formatted file:
    ~/.npmrc
or on the command line via: npm <command> --key value
Config info can be viewed via: npm help config
```

Для того чтобы узнать текущую версию `npm` достаточно запустить
```bash
$> npm -v
5.8.0
```

Для установки пакетов используется команда `npm install <имя пакета>`. 

Существует два варианта установки npm пакетов: локалько и глобально. Выбор того или иного варинта зависит от того, как вы хотите использовать пакет:
* Если вы хотите использовать пакет в качестве зависимтости в своём модуле, тогда устанавливайте локально. Такой вариант установки используется по умолчанию
* Если пакет нужен в качестве инструмента командной строки (напрмиер, сам npm или сборка gulp и т.п.), тогда пакет устанавливается глобально

При установке пакет скачивается вместе со своими зависимостям из репозиотря. Репозиторий npm, расположенный по адресу (https://www.npmjs.com), представляет собой огромную базу пакетов, которые пополняются ежедневно. В репозитории все пакеты имееют уникальные имена и соответствующую этом имени историю версий.

Установим пакет [lodash](https://lodash.com) в свой проект. Для этого сначала в папке проект необходимо создать файл `package.json` с описанием проекта. Для этого нужно выполнить 
```bash
$> npm init
```
Во время выполнения нужно будет запонить поля
* название проекта - по умолчанию название папки проекта
* версия - по умолчанию 1.0.0
* описание - по умолчанию пусто
* ссылка на гит репозиторий - по умолчанию пусто
* авторы - по умолчанию пусто
* лицензия - - по умолчанию ISC

После выполнения данной команды можно выполнить
```bash
$> npm install lodash
```

После этого в папке проекта появится директория `node_modules/lodash` - это и есть папка установленного пакета со всеми его файлами.

npm сам является nodejs пакетом, поэтому его тоже можно устанавливать и обновлять из репозитория. Для примера попробуем установить последнюю версию npm. Для глобальной установки используется дополнительный флаг `-g`
```
$> npm install npm@latest -g
```
Теперь при запуске `npm -v` будет отображаться последняя версия. Чтобы это проверить достаточно открыть страницу нужного пакета https://www.npmjs.com/package/npm



