Введение в пакеные менеджеры
===

## Модульные системы

### Что такое модули и модульные системы

**Модульное программирование** — это организация программы как совокупности небольших независимых блоков, называемых модулями, структура и поведение которых подчиняются определённым правилам. Использование модульного программирования позволяет упростить тестирование программы и обнаружение ошибок.

*Модуль* — функционально законченный фрагмент программы. Обычно оформляется в виде отдельного файла с исходным кодом или поименованной непрерывной её части. Некоторые языки предусматривают объединение модулей в пакеты.

Модули могут разрабатываться и поставляться независимо от основного проекта. Причем разработкой отдельных модулей могут заниматься различные команды. Данный подход позволяет переиспользовать в различных проектах просто подключая уже готовый функционал

В этом случае внешние модули становятся так называемыми **зависимостями** основного проекта. 

### Модули = зависимости

Во время использовании сторонних модулей (библиотек, утилит и т.п.) возникает проблема поддержки актуальной версии этих зависимостей. 
Например при выходе исправлений в текущей версии библиотеки нужно обновить ее в проекте. 

Так как сама библиотека не является частью проекта, то класть ее под версионный контроль не очень хорошо - в процессе может измениться большое количество файлов. Также при этом репозиторий раздувается файлами, которые не относятся к проекту.

Поэтому зависимости принято описывать в специальном файле и каждый разработчик заботится о том чтобы у него был актуальный набор зависимостей.

### Консистентность модулей

Возникает еще одна проблема: у зависимостей могут быть свои зависимости. И их тоже нужно поддерживать в актаульном состоянии. При этом у некоторых библиотек могут быть общие зависимости. В этом случае нужно решить где их хранить: для каждой библиотеки в своей папке или где то на одном уровне с библиотеками и давать им способ доступа к общим зависимостям

## Система управления пакетами
**Система управления пакетами (пакетный менеджер)** — набор программного обеспечения, позволяющего управлять процессом установки, удаления, настройки и обновления различных компонентов программного обеспечения. Системы управления пакетами активно используются в различных дистрибутивах операционной системы Linux и других UNIX-подобных операционных системах.

Для использования в системах управления пакетами программное обеспечение представляется в виде особых пакетов, содержащих помимо дистрибутива набор определённых метаданных, которые могут включать в себя полное имя пакета, номер версии, описание пакета, имя разработчика, контрольную сумму, отношения с другими пакетами. Метаданные сохраняются в системной базе данных пакетов.

Из известных пакетных менеджеров следует упомянуть *rpm* и *dpkg*, используемые в различных дистрибутивах Linux.

Также используются пакетные менеджеры для различных языков программирования:
* npm для javascript
* pip для python
* gem для ruby on rails
* composer для php

Как правило, система управления пакетами работает со множеством пакетов, хранящихся в специальном репозитории — хранилище, которое  располагается на удалённой сервере и достпуно по различным протоколам (HTTP, FTP или rsync-сервере).


## npm - nodejs package manager
**npm** - пакетный менеджер, поставляемый вместе с [nodejs](https://nodejs.org/en/). Для установки npm достаточно скачать установщик с сайта (https://nodejs.org/en). 

После установки в командной строке будут доступны команды `node` и `npm`

Запуск без агрументов позволяет просмотреть доступные команды
```bash
$> npm
Usage: npm <command>

where <command> is one of:
    access, adduser, bin, bugs, c, cache, completion, config,
    ddp, dedupe, deprecate, dist-tag, docs, doctor, edit,
    explore, get, help, help-search, i, init, install,
    install-test, it, link, list, ln, login, logout, ls,
    outdated, owner, pack, ping, prefix, prune, publish, rb,
    rebuild, repo, restart, root, run, run-script, s, se,
    search, set, shrinkwrap, star, stars, start, stop, t, team,
    test, tst, un, uninstall, unpublish, unstar, up, update, v,
    version, view, whoami

npm <command> -h     quick help on <command>
npm -l           display full usage info
npm help <term>  search for help on <term>
npm help npm     involved overview

Specify configs in the ini-formatted file:
    ~/.npmrc
or on the command line via: npm <command> --key value
Config info can be viewed via: npm help config
```

Для того чтобы узнать текущую версию `npm` достаточно запустить
```bash
$> npm -v
5.8.0
```

Для установки пакетов используется команда `npm install <имя пакета>`. 

Существует два варианта установки npm пакетов: локалько и глобально. Выбор того или иного варинта зависит от того, как вы хотите использовать пакет:
* Если вы хотите использовать пакет в качестве зависимтости в своём модуле, тогда устанавливайте локально. Такой вариант установки используется по умолчанию
* Если пакет нужен в качестве инструмента командной строки (напрмиер, сам npm или сборка gulp и т.п.), тогда пакет устанавливается глобально

При усановке пакет скачивается вместе со своими зависимостям из репозиотря. Репозиторий npm, расположенный по адресу (https://www.npmjs.com), представляет собой огромную базу пакетов, которые пополняются ежедневно. В репозитории все пакеты имееют уникальные имена и соответствующую этом имени историю версий.

Установим пакет [lodash](https://lodash.com) в свой проект. Для этого сначала в папке проект необходимо создать файл `package.json` с описанием проекта. Для этого нужно выполнить 
```bash
$> npm init
```
Во время выполнения нужно будет запонить поля
* название проекта - по умолчанию название папки проекта
* версия - по умолчанию 1.0.0
* описание - по умолчанию пусто
* ссылка на гит репозиторий - по умолчанию пусто
* авторы - по умолчанию пусто
* лицензия - - по умолчанию ISC

После выполнения данной команды можно выполнить
```bash
$> npm install lodash
```

После этого в папке проекта появится директория `node_modules/lodash` - это и есть папка установленного пакета со всеми его файлами.

npm сам является nodejs пакетом, поэтому его тоже можно устанавливать и обновлять из репозитория. Для примера попробуем установить последнюю версию npm. Для глобальной установки используется дополнительный флаг `-g`
```
$> npm install npm@latest -g
```
Теперь при запуске `npm -v` будет отображаться последняя версия. Чтобы это проверить достаточно открыть страницу нужного пакета https://www.npmjs.com/package/npm



